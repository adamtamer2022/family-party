<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ù‚Ø§Ø¹Ø¯</title>
<style>
  body { text-align: center; background: #222; color: white; font-family: sans-serif; }
  .row { margin: 10px; }
  .seat {
    width: 40px; height: 40px; margin: 5px;
    display: inline-block; background: green;
    border-radius: 5px; cursor: pointer;
  }
  .seat.booked { background: red; }
</style>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
</head>
<body>
<h2>ðŸ“± Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
<div id="hall"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
  import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAVzRmVlUcyXsg25KM26_wJs-QMuF52k2o",
    authDomain: "frist-3a4ee.firebaseapp.com",
    databaseURL: "https://frist-3a4ee-default-rtdb.firebaseio.com",
    projectId: "frist-3a4ee",
    storageBucket: "frist-3a4ee.appspot.com",
    messagingSenderId: "1098758189245",
    appId: "1:1098758189245:web:dddd9e453767b7629387d4",
    measurementId: "G-K9JNSJPXXN"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const hall = document.getElementById("hall");

  // Ø±Ø³Ù… Ø§Ù„ÙƒØ±Ø§Ø³ÙŠ
  const rows = ["A","B","C","D","E"];
  rows.forEach(r => {
    const rowDiv = document.createElement("div");
    rowDiv.className = "row";
    for (let i=1; i<=8; i++) {
      const seat = document.createElement("div");
      seat.className = "seat";
      seat.setAttribute("data-id", r+i);
      rowDiv.appendChild(seat);

      const seatRef = ref(db, "seats/" + r+i);
      onValue(seatRef, snapshot => {
        if (snapshot.val() === "booked") {
          seat.classList.add("booked");
        } else {
          seat.classList.remove("booked");
        }
      });

      seat.addEventListener("click", () => {
        const booked = seat.classList.contains("booked");
        set(seatRef, booked ? "free" : "booked");
      });
    }
    hall.appendChild(rowDiv);
  });
</script>
</body>
</html>
